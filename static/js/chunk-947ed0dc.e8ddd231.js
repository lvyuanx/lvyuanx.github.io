(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-947ed0dc"],{"0b42":function(e,t,n){var a=n("da84"),s=n("e8b5"),r=n("68ee"),i=n("861d"),o=n("b622"),c=o("species"),l=a.Array;e.exports=function(e){var t;return s(e)&&(t=e.constructor,r(t)&&(t===l||s(t.prototype))?t=void 0:i(t)&&(t=t[c],null===t&&(t=void 0))),void 0===t?l:t}},"0c3e":function(e,t,n){"use strict";n("735e")},"159b":function(e,t,n){var a=n("da84"),s=n("fdbc"),r=n("785a"),i=n("17c2"),o=n("9112"),c=function(e){if(e&&e.forEach!==i)try{o(e,"forEach",i)}catch(t){e.forEach=i}};for(var l in s)s[l]&&c(a[l]&&a[l].prototype);c(r)},"17c2":function(e,t,n){"use strict";var a=n("b727").forEach,s=n("a640"),r=s("forEach");e.exports=r?[].forEach:function(e){return a(this,e,arguments.length>1?arguments[1]:void 0)}},"1dde":function(e,t,n){var a=n("d039"),s=n("b622"),r=n("2d00"),i=s("species");e.exports=function(e){return r>=51||!a((function(){var t=[],n=t.constructor={};return n[i]=function(){return{foo:1}},1!==t[e](Boolean).foo}))}},"408a":function(e,t,n){var a=n("e330");e.exports=a(1..valueOf)},5899:function(e,t){e.exports="\t\n\v\f\r                　\u2028\u2029\ufeff"},"58a8":function(e,t,n){var a=n("e330"),s=n("1d80"),r=n("577e"),i=n("5899"),o=a("".replace),c="["+i+"]",l=RegExp("^"+c+c+"*"),f=RegExp(c+c+"*$"),u=function(e){return function(t){var n=r(s(t));return 1&e&&(n=o(n,l,"")),2&e&&(n=o(n,f,"")),n}};e.exports={start:u(1),end:u(2),trim:u(3)}},"65f0":function(e,t,n){var a=n("0b42");e.exports=function(e,t){return new(a(e))(0===t?0:t)}},7156:function(e,t,n){var a=n("1626"),s=n("861d"),r=n("d2bb");e.exports=function(e,t,n){var i,o;return r&&a(i=t.constructor)&&i!==n&&s(o=i.prototype)&&o!==n.prototype&&r(e,o),e}},"735e":function(e,t,n){},"79f7":function(e,t,n){"use strict";n.r(t);var a=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"box"},[n("nav-top-bar",{attrs:{leftArrow:!0,rightArrow:!0,title:"社区消息"}}),n("van-tabs",{staticClass:"box tabBox",model:{value:e.active,callback:function(t){e.active=t},expression:"active"}},[n("van-tab",{staticClass:"box",attrs:{title:"未读"}}),n("van-tab",{attrs:{title:"已读"}}),n("list-group",{attrs:{active:e.active}})],1)],1)},s=[],r=n("a5d7"),i=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"box"},[n("form",{attrs:{action:"/"}},[n("van-search",{attrs:{placeholder:"请输入搜索关键词"},model:{value:e.query.subject,callback:function(t){e.$set(e.query,"subject",t)},expression:"query.subject"}})],1),n("van-pull-refresh",{staticClass:"box",on:{refresh:e.onRefresh},model:{value:e.refreshing,callback:function(t){e.refreshing=t},expression:"refreshing"}},[n("van-list",{attrs:{"immediate-check":!0,error:e.error,finished:e.finished,"finished-text":"没有更多了","error-text":"请求失败，点击重新加载"},on:{"update:error":function(t){e.error=t},load:e.onLoad},model:{value:e.loading,callback:function(t){e.loading=t},expression:"loading"}},e._l(e.list,(function(t){return n("message-item",{key:t.emailId,attrs:{active:e.active,messageInfo:t}})})),1)],1),n("van-dialog",{attrs:{title:e.selectMessageInfo.subject},model:{value:e.show,callback:function(t){e.show=t},expression:"show"}},[n("div",{staticClass:"box infoBox"},[n("van-field",{attrs:{label:"发件人",readonly:""},model:{value:e.selectMessageInfo.fromUserName,callback:function(t){e.$set(e.selectMessageInfo,"fromUserName",t)},expression:"selectMessageInfo.fromUserName"}}),n("van-field",{attrs:{label:"收件人",readonly:""},model:{value:e.selectMessageInfo.toUserName,callback:function(t){e.$set(e.selectMessageInfo,"toUserName",t)},expression:"selectMessageInfo.toUserName"}}),n("van-field",{attrs:{label:"是否邮件提醒",readonly:""},model:{value:e.isEmailStr,callback:function(t){e.isEmailStr=t},expression:"isEmailStr"}}),n("van-field",{attrs:{label:"发件时间",readonly:""},model:{value:e.selectMessageInfo.emailCreateDate,callback:function(t){e.$set(e.selectMessageInfo,"emailCreateDate",t)},expression:"selectMessageInfo.emailCreateDate"}}),n("van-field",{attrs:{label:"主题",readonly:""},model:{value:e.selectMessageInfo.subject,callback:function(t){e.$set(e.selectMessageInfo,"subject",t)},expression:"selectMessageInfo.subject"}}),n("van-field",{attrs:{rows:"3",type:"textarea",label:"内容",readonly:""},model:{value:e.selectMessageInfo.content,callback:function(t){e.$set(e.selectMessageInfo,"content",t)},expression:"selectMessageInfo.content"}})],1)])],1)},o=[],c=(n("a9e3"),n("a434"),n("d3b7"),n("159b"),n("7c15")),l=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"box itemBox"},[n("van-swipe-cell",{scopedSlots:e._u([e.active?{key:"right",fn:function(){return[n("van-button",{staticStyle:{height:"100%"},attrs:{square:"",type:"primary",text:"标为未读"},on:{click:e.noRead}})]},proxy:!0}:null],null,!0)},[n("van-cell",{attrs:{center:"",title:e.messageInfo.subject,value:e.messageInfo.emailCreateDate,clickable:"",label:e.subContent},on:{click:e.showInfo}})],1)],1)},f=[],u={props:{messageInfo:{type:Object,required:!0,default:0},active:{type:Number,required:!1,default:0}},name:"MessageItem",computed:{subContent:function(){return this.messageInfo.content.length<20?this.messageInfo.content:this.messageInfo.content.substr(0,20)+"..."}},methods:{showInfo:function(){this.$bus.$emit("showInfo",this.messageInfo)},noRead:function(){this.$bus.$emit("noRead",this.messageInfo.emailId)}}},d=u,h=(n("df22"),n("2877")),g=Object(h["a"])(d,l,f,!1,null,"29da234a",null),p=g.exports,b={props:{active:{type:Number,required:!1,default:0}},name:"ListGroup",components:{MessageItem:p},data:function(){return{show:!1,refreshing:!1,loading:!1,finished:!1,error:!1,pageInfo:{pageSize:6,pageNum:1,hasNextPage:!1,hasPreviousPage:!1,isFirstPage:!0,isLastPage:!0},list:[],query:{isEnable:0,subject:""},selectMessageInfo:{}}},watch:{query:{deep:!0,immediate:!1,handler:function(e,t){this.list.splice(0,this.list.length),this.handlPage(),this.findMessage()}},active:{immediate:!0,handler:function(e,t){this.query.isEnable=e}}},computed:{isEmailStr:function(){return 0==this.selectMessageInfo.isEmail?"否":"是"}},created:function(){this.findMessage()},mounted:function(){var e=this;this.$bus.$on("showInfo",(function(t){e.selectMessageInfo=t,e.show=!0,e.readMessage(1),0==e.active&&e.list.forEach((function(t,n){t.emailId==e.selectMessageInfo.emailId&&e.list.splice(n,1)}))})),this.$bus.$on("noRead",(function(t){e.selectMessageInfo.emailId=t,e.readMessage(0),e.list.forEach((function(n,a){n.emailId==t&&e.list.splice(a,1)}))}))},beforeDestroy:function(){this.$bus.$off("showInfo"),this.$bus.$off("noRead")},methods:{readMessage:function(e){var t=this,n={emailId:this.selectMessageInfo.emailId,isEnable:e};Object(c["H"])(n).then((function(e){200==e.code?console.log("消息读取成功"):t.$toast("消息读取失败")}))},findMessage:function(){var e=this,t={pageSize:this.pageInfo.pageSize,pageNum:this.pageInfo.pageNum,isEnable:this.query.isEnable,subject:this.query.subject};Object(c["s"])(t).then((function(t){200==t.code?(e.handlQuery(t.data),t.data.list.length>0&&t.data.list.forEach((function(t){return e.list.push(t)}))):e.$toast(t.message),e.refreshing=!1,e.loading=!1,t.data.hasNextPage?e.finished=!1:e.finished=!0}))},onRefresh:function(){this.refreshing=!0,this.list.splice(0,this.list.length),this.pageInfo.pageSize=6,this.pageInfo.pageNum=1,this.findMessage()},handlQuery:function(e){this.pageInfo.hasNextPage=e.hasNextPage,this.pageInfo.hasPreviousPage=e.hasPreviousPage,this.pageInfo.isFirstPage=e.isFirstPage,this.pageInfo.isLastPage=e.isLastPage},onLoad:function(){this.pageInfo.hasNextPage?(this.loading=!0,this.pageInfo.pageNum++,this.findMessage()):(this.loading=!1,this.finished=!0)},handlPage:function(){this.pageInfo={pageSize:6,pageNum:1,hasNextPage:!1,hasPreviousPage:!1,isFirstPage:!0,isLastPage:!0}}}},m=b,v=(n("0c3e"),Object(h["a"])(m,i,o,!1,null,"745e601d",null)),I=v.exports,x={components:{NavTopBar:r["a"],ListGroup:I},name:"MessageList",data:function(){return{active:0}}},y=x,N=Object(h["a"])(y,a,s,!1,null,null,null);t["default"]=N.exports},8418:function(e,t,n){"use strict";var a=n("a04b"),s=n("9bf2"),r=n("5c6c");e.exports=function(e,t,n){var i=a(t);i in e?s.f(e,i,r(0,n)):e[i]=n}},a434:function(e,t,n){"use strict";var a=n("23e7"),s=n("da84"),r=n("23cb"),i=n("5926"),o=n("07fa"),c=n("7b0b"),l=n("65f0"),f=n("8418"),u=n("1dde"),d=u("splice"),h=s.TypeError,g=Math.max,p=Math.min,b=9007199254740991,m="Maximum allowed length exceeded";a({target:"Array",proto:!0,forced:!d},{splice:function(e,t){var n,a,s,u,d,v,I=c(this),x=o(I),y=r(e,x),N=arguments.length;if(0===N?n=a=0:1===N?(n=0,a=x-y):(n=N-2,a=p(g(i(t),0),x-y)),x+n-a>b)throw h(m);for(s=l(I,a),u=0;u<a;u++)d=y+u,d in I&&f(s,u,I[d]);if(s.length=a,n<a){for(u=y;u<x-a;u++)d=u+a,v=u+n,d in I?I[v]=I[d]:delete I[v];for(u=x;u>x-a+n;u--)delete I[u-1]}else if(n>a)for(u=x-a;u>y;u--)d=u+a-1,v=u+n-1,d in I?I[v]=I[d]:delete I[v];for(u=0;u<n;u++)I[u+y]=arguments[u+2];return I.length=x-a+n,s}})},a5d7:function(e,t,n){"use strict";var a=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("van-sticky",{attrs:{"offset-top":0}},[n("van-nav-bar",{attrs:{title:e.title,"left-text":e.leftText,"left-arrow":e.leftArrow,fixed:"",placeholder:""},on:{"click-left":e.onClickLeft,"click-right":e.onClickRight},scopedSlots:e._u([e.rightArrow?{key:"right",fn:function(){return[n("van-icon",{attrs:{name:"wap-home-o",size:"18"}})]},proxy:!0}:null],null,!0)})],1)},s=[],r=(n("ac1f"),n("5319"),{name:"NavTopBar",props:["title","leftArrow","rightArrow"],data:function(){return{leftTextStr:"返回"}},methods:{onClickLeft:function(){this.$router.go(-1)},onClickRight:function(){this.$router.replace({name:"home"})}},computed:{leftText:function(){return this.leftArrow?this.leftTextStr:""}}}),i=r,o=n("2877"),c=Object(o["a"])(i,a,s,!1,null,"72fa6fb3",null);t["a"]=c.exports},a640:function(e,t,n){"use strict";var a=n("d039");e.exports=function(e,t){var n=[][e];return!!n&&a((function(){n.call(null,t||function(){throw 1},1)}))}},a9e3:function(e,t,n){"use strict";var a=n("83ab"),s=n("da84"),r=n("e330"),i=n("94ca"),o=n("6eeb"),c=n("1a2d"),l=n("7156"),f=n("3a9b"),u=n("d9b5"),d=n("c04e"),h=n("d039"),g=n("241c").f,p=n("06cf").f,b=n("9bf2").f,m=n("408a"),v=n("58a8").trim,I="Number",x=s[I],y=x.prototype,N=s.TypeError,E=r("".slice),M=r("".charCodeAt),w=function(e){var t=d(e,"number");return"bigint"==typeof t?t:k(t)},k=function(e){var t,n,a,s,r,i,o,c,l=d(e,"number");if(u(l))throw N("Cannot convert a Symbol value to a number");if("string"==typeof l&&l.length>2)if(l=v(l),t=M(l,0),43===t||45===t){if(n=M(l,2),88===n||120===n)return NaN}else if(48===t){switch(M(l,1)){case 66:case 98:a=2,s=49;break;case 79:case 111:a=8,s=55;break;default:return+l}for(r=E(l,2),i=r.length,o=0;o<i;o++)if(c=M(r,o),c<48||c>s)return NaN;return parseInt(r,a)}return+l};if(i(I,!x(" 0o1")||!x("0b1")||x("+0x1"))){for(var $,P=function(e){var t=arguments.length<1?0:x(w(e)),n=this;return f(y,n)&&h((function(){m(n)}))?l(Object(t),n,P):t},S=a?g(x):"MAX_VALUE,MIN_VALUE,NaN,NEGATIVE_INFINITY,POSITIVE_INFINITY,EPSILON,MAX_SAFE_INTEGER,MIN_SAFE_INTEGER,isFinite,isInteger,isNaN,isSafeInteger,parseFloat,parseInt,fromString,range".split(","),j=0;S.length>j;j++)c(x,$=S[j])&&!c(P,$)&&b(P,$,p(x,$));P.prototype=y,y.constructor=P,o(s,I,P)}},b727:function(e,t,n){var a=n("0366"),s=n("e330"),r=n("44ad"),i=n("7b0b"),o=n("07fa"),c=n("65f0"),l=s([].push),f=function(e){var t=1==e,n=2==e,s=3==e,f=4==e,u=6==e,d=7==e,h=5==e||u;return function(g,p,b,m){for(var v,I,x=i(g),y=r(x),N=a(p,b),E=o(y),M=0,w=m||c,k=t?w(g,E):n||d?w(g,0):void 0;E>M;M++)if((h||M in y)&&(v=y[M],I=N(v,M,x),e))if(t)k[M]=I;else if(I)switch(e){case 3:return!0;case 5:return v;case 6:return M;case 2:l(k,v)}else switch(e){case 4:return!1;case 7:l(k,v)}return u?-1:s||f?f:k}};e.exports={forEach:f(0),map:f(1),filter:f(2),some:f(3),every:f(4),find:f(5),findIndex:f(6),filterReject:f(7)}},df22:function(e,t,n){"use strict";n("ed7e")},e8b5:function(e,t,n){var a=n("c6b6");e.exports=Array.isArray||function(e){return"Array"==a(e)}},ed7e:function(e,t,n){}}]);
//# sourceMappingURL=chunk-947ed0dc.e8ddd231.js.map